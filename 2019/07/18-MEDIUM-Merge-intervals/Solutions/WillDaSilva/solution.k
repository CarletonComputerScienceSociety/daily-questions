{(,x@0){($[~<[r:*|*|x;y@0];.[x;(-1+#x;1);:;max(r;y@1)];x,,y])}/x[<x]}

